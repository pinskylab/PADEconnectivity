#### Filtering commands used to generate the final genotypes used in “Evidence for extensive larval dispersal in summer flounder across space and through time using multiple natural tags.” The input is a vcf file of unfiltered SNPs resulting from the dDocent v. 2.23 pipeline (TotalRawSNPs.vcf). ####

1. Keep SNPs genotyped in 50% of individuals and a minor allele count of 3:

[jennh@amphiprion 07_PADE_analysis]$ vcftools --vcf TotalRawSNPs.vcf --geno 0.5 --mac 3 --recode --recode-INFO-all --out raw.g5mac3

2. Recode any genotypes with fewer than three reads as ‘missing’:

[jennh@amphiprion 07_PADE_analysis]$ vcftools --vcf raw.g5mac3.recode.vcf --minDP 3 --recode --recode-INFO-all --out raw.g5mac3.dp3

3. Restrict data to individuals with less than 75% missing data:

[jennh@amphiprion 07_PADE_analysis]$ filter_missing_ind.sh raw.g5mac3.dp3.recode.vcf raw.g5mac3.dp3lm75

4. Keep SNPs occurring in 95% of individuals with a minor allele frequency of 0.05, a minimum mean depth of 20 and a q-value above 30:

[jennh@amphiprion 07_PADE_analysis]$ vcftools --vcf raw.g5mac3.dp3lm75.recode.vcf --geno 0.95 --maf 0.05 --recode --recode-INFO-all --out DP3g95maf05lm75 --min-meanDP 20 --minQ 30

5. Begin filtering with filtering script (dDocent_filters) distributed with dDocent and default settings:

[jennh@amphiprion 07_PADE_analysis]$ dDocent_filters DP3g95maf05lm75.recode.vcf DP3g95maf05lm75

6. Convert file to SNPs only and indicate SNPs and indels:

[jennh@amphiprion 07_PADE_analysis]$ vcfallelicprimitives DP3g95maf05lm75.recode.vcf --keep-info --keep-geno > DP3g95maf05lm75.FIL.prim.vcf

7. Remove indels:

[jennh@amphiprion 07_PADE_analysis]$ vcftools --vcf DP3g95maf05lm75.FIL.prim.vcf --remove-indels --recode --recode-INFO-all --out SNP.DP3g95maf05lm75.FIL

#### This should result in a file (SNP.DP3g95maf05lm75.FIL.recode.vcf) with 3827 SNPs across 528 fish (235 adult & 293 larvae) ####
